---
description: این فصل به شما کمک می‌کند تا ساختار دستورات Vim را درک کنید و با یادگیری
  قواعد گرامری، به راحتی با زبان Vim ارتباط برقرار کنید.
title: Ch04. Vim Grammar
---

به راحتی می‌توان از پیچیدگی دستورات Vim ترسید. اگر یک کاربر Vim را ببینید که `gUfV` یا `1GdG` را انجام می‌دهد، ممکن است بلافاصله ندانید که این دستورات چه کاری انجام می‌دهند. در این فصل، ساختار کلی دستورات Vim را به یک قاعده گرامری ساده تقسیم می‌کنم.

این مهم‌ترین فصل در کل راهنما است. وقتی ساختار گرامری زیرین را درک کنید، قادر خواهید بود با Vim "صحبت" کنید. به هر حال، وقتی در این فصل از *زبان Vim* صحبت می‌کنم، منظورم زبان Vimscript نیست (زبان برنامه‌نویسی داخلی Vim که در فصل‌های بعدی یاد خواهید گرفت).

## چگونه یک زبان را یاد بگیریم

من یک سخنران بومی انگلیسی نیستم. من زبان انگلیسی را زمانی که ۱۳ ساله بودم و به ایالات متحده منتقل شدم، یاد گرفتم. برای یادگیری صحبت کردن به یک زبان جدید، باید سه کار انجام دهید:

1. یادگیری قواعد گرامری.
2. افزایش دایره واژگان.
3. تمرین، تمرین، تمرین.

به همین ترتیب، برای صحبت کردن به زبان Vim، باید قواعد گرامری را یاد بگیرید، دایره واژگان را افزایش دهید و تمرین کنید تا بتوانید دستورات را بدون فکر کردن اجرا کنید.

## قاعده گرامری

تنها یک قاعده گرامری در زبان Vim وجود دارد:

```shell
فعل + اسم
```

فقط همین!

این مانند گفتن این عبارات انگلیسی است:

- *"بخور (فعل) یک دونات (اسم)"*
- *"پا بزن (فعل) به یک توپ (اسم)"*
- *"یاد بگیر (فعل) ویرایشگر Vim (اسم)"*

حالا شما باید دایره واژگان خود را با افعال و اسم‌های پایه Vim بسازید.

## اسم‌ها (حرکات)

اسم‌ها حرکات Vim هستند. حرکات برای جابه‌جایی در Vim استفاده می‌شوند. در زیر فهرستی از برخی حرکات Vim آورده شده است:

```shell
h    چپ
j    پایین
k    بالا
l    راست
w    به جلو به ابتدای کلمه بعدی بروید
}    به پاراگراف بعدی بپرید
$    به انتهای خط بروید
```

شما در فصل بعدی بیشتر در مورد حرکات یاد خواهید گرفت، بنابراین اگر برخی از آن‌ها را درک نمی‌کنید، نگران نباشید.

## افعال (عملگرها)

طبق `:h operator`، Vim دارای ۱۶ عملگر است. با این حال، به تجربه من، یادگیری این ۳ عملگر برای ۸۰٪ نیازهای ویرایشی من کافی است:

```shell
y    متن را کپی کنید (کپی)
d    متن را حذف کرده و در ثبت ذخیره کنید
c    متن را حذف کرده، در ثبت ذخیره کنید و حالت وارد کردن را شروع کنید
```

به هر حال، بعد از اینکه متنی را کپی کردید، می‌توانید آن را با `p` (بعد از نشانگر) یا `P` (قبل از نشانگر) بچسبانید.

## فعل و اسم

حالا که افعال و اسم‌های پایه را می‌دانید، بیایید قاعده گرامری را اعمال کنیم، فعل + اسم! فرض کنید این عبارت را دارید:

```javascript
const learn = "vim";
```

- برای کپی کردن همه چیز از مکان فعلی شما تا انتهای خط: `y$`.
- برای حذف از مکان فعلی شما تا ابتدای کلمه بعدی: `dw`.
- برای تغییر از مکان فعلی شما تا انتهای پاراگراف فعلی، بگویید `c}`.

حرکات همچنین می‌توانند شماره شمارش را به عنوان آرگومان بپذیرند (در فصل بعدی در مورد این موضوع صحبت خواهم کرد). اگر نیاز دارید ۳ خط بالا بروید، به جای فشار دادن `k` ۳ بار، می‌توانید `3k` را انجام دهید. شمارش با گرامر Vim کار می‌کند.
- برای کپی کردن دو کاراکتر به سمت چپ: `y2h`.
- برای حذف دو کلمه بعدی: `d2w`.
- برای تغییر دو خط بعدی: `c2j`.

در حال حاضر، ممکن است مجبور باشید به طور طولانی و سخت فکر کنید تا حتی یک دستور ساده را اجرا کنید. شما تنها نیستید. وقتی من برای اولین بار شروع کردم، با مشکلات مشابهی روبرو شدم اما با گذشت زمان سریع‌تر شدم. شما هم همینطور خواهید شد. تکرار، تکرار، تکرار.

به عنوان یک نکته جانبی، عملیات خطی (عملیات‌هایی که بر کل خط تأثیر می‌گذارند) عملیات رایجی در ویرایش متن هستند. به طور کلی، با تایپ کردن یک دستور عملگر دو بار، Vim یک عملیات خطی برای آن عمل انجام می‌دهد. به عنوان مثال، `dd`، `yy` و `cc` **حذف**، **کپی** و **تغییر** را بر روی کل خط انجام می‌دهند. این را با سایر عملگرها امتحان کنید!

این واقعاً جالب است. من یک الگو اینجا می‌بینم. اما هنوز تمام نشده‌ام. Vim یک نوع دیگر از اسم دارد: اشیاء متنی.

## اسم‌های بیشتر (اشیاء متنی)

تصور کنید که شما در جایی داخل یک جفت پرانتز مانند `(hello Vim)` هستید و نیاز دارید که کل عبارت داخل پرانتز را حذف کنید. چگونه می‌توانید به سرعت این کار را انجام دهید؟ آیا راهی برای حذف "گروه" که در آن هستید وجود دارد؟

پاسخ بله است. متن‌ها معمولاً ساختار یافته هستند. آن‌ها معمولاً شامل پرانتز، نقل قول، براکت، براس و بیشتر هستند. Vim راهی برای ضبط این ساختار با اشیاء متنی دارد.

اشیاء متنی با عملگرها استفاده می‌شوند. دو نوع شیء متنی وجود دارد: اشیاء متنی داخلی و خارجی.

```shell
i + object    شیء متنی داخلی
a + object    شیء متنی خارجی
```

شیء متنی داخلی شیء را *بدون* فضای خالی یا اشیاء اطراف انتخاب می‌کند. شیء متنی خارجی شیء را *شامل* فضای خالی یا اشیاء اطراف انتخاب می‌کند. به طور کلی، یک شیء متنی خارجی همیشه متن بیشتری نسبت به یک شیء متنی داخلی انتخاب می‌کند. اگر نشانگر شما در جایی داخل پرانتز در عبارت `(hello Vim)` باشد:
- برای حذف متن داخل پرانتز بدون حذف پرانتز: `di(`.
- برای حذف پرانتز و متن داخل آن: `da(`.

بیایید به یک مثال دیگر نگاه کنیم. فرض کنید این تابع Javascript را دارید و نشانگر شما بر روی "H" در "Hello" است:

```javascript
const hello = function() {
  console.log("Hello Vim");
  return true;
}
```

- برای حذف کل "Hello Vim": `di(`.
- برای حذف محتوای تابع (احاطه شده با `{}`): `di{`.
- برای حذف رشته "Hello": `diw`.

اشیاء متنی قدرتمند هستند زیرا می‌توانید اشیاء مختلفی را از یک مکان هدف قرار دهید. می‌توانید اشیاء داخل پرانتز، بلوک تابع یا کلمه فعلی را حذف کنید. به طور یادآورانه، وقتی `di(`، `di{` و `diw` را می‌بینید، ایده خوبی از اینکه این اشیاء متنی چه چیزی را نمایندگی می‌کنند به دست می‌آورید: یک جفت پرانتز، یک جفت براس و یک کلمه.

بیایید به یک مثال آخر نگاه کنیم. فرض کنید این برچسب‌های HTML را دارید:

```html
<div>
  <h1>Header1</h1>
  <p>Paragraph1</p>
  <p>Paragraph2</p>
</div>
```

اگر نشانگر شما بر روی متن "Header1" باشد:
- برای حذف "Header1": `dit`.
- برای حذف `<h1>Header1</h1>`: `dat`.

اگر نشانگر شما بر روی "div" باشد:
- برای حذف `h1` و هر دو خط `p`: `dit`.
- برای حذف همه چیز: `dat`.
- برای حذف "div": `di<`.

در زیر فهرستی از اشیاء متنی رایج آورده شده است:

```shell
w         یک کلمه
p         یک پاراگراف
s         یک جمله
( or )    یک جفت از ( )
{ or }    یک جفت از { }
[ or ]    یک جفت از [ ]
< or >    یک جفت از < >
t         برچسب‌های XML
"         یک جفت از " "
'         یک جفت از ' '
`         یک جفت از ` `
```

برای یادگیری بیشتر، به `:h text-objects` مراجعه کنید.

## قابلیت ترکیب‌پذیری و گرامر

گرامر Vim زیرمجموعه‌ای از ویژگی ترکیب‌پذیری Vim است. بیایید در مورد ترکیب‌پذیری در Vim و اینکه چرا این یک ویژگی عالی در یک ویرایشگر متن است، صحبت کنیم.

ترکیب‌پذیری به معنای داشتن مجموعه‌ای از دستورات عمومی است که می‌توانند ترکیب (ترکیب) شوند تا دستورات پیچیده‌تری را انجام دهند. درست مانند برنامه‌نویسی که می‌توانید انتزاعات پیچیده‌تری از انتزاعات ساده‌تر ایجاد کنید، در Vim می‌توانید دستورات پیچیده را از دستورات ساده‌تر اجرا کنید. گرامر Vim تجلی طبیعت ترکیب‌پذیر Vim است.

قدرت واقعی ترکیب‌پذیری Vim زمانی درخشان می‌شود که با برنامه‌های خارجی ادغام شود. Vim دارای یک عملگر فیلتر (`!`) است که برای استفاده از برنامه‌های خارجی به عنوان فیلتر برای متون ما استفاده می‌شود. فرض کنید این متن نامنظم را دارید و می‌خواهید آن را جدولی کنید:

```shell
Id|Name|Cuteness
01|Puppy|Very
02|Kitten|Ok
03|Bunny|Ok
```

این کار به راحتی با دستورات Vim انجام نمی‌شود، اما می‌توانید آن را به سرعت با دستور ترمینال `column` انجام دهید (با فرض اینکه ترمینال شما دستور `column` را دارد). با نشانگر خود بر روی "Id"، دستور `!}column -t -s "|"` را اجرا کنید. Voilà! حالا شما این داده‌های جدولی زیبا را با فقط یک دستور سریع دارید.

```shell
Id  Name    Cuteness
01  Puppy   Very
02  Kitten  Ok
03  Bunny   Ok
```

بیایید دستور را تجزیه و تحلیل کنیم. فعل `!` (عملگر فیلتر) و اسم `}` (بروید به پاراگراف بعدی) بود. عملگر فیلتر `!` یک آرگومان دیگر، یک دستور ترمینال، را پذیرفت، بنابراین من `column -t -s "|"` را به آن دادم. من نمی‌خواهم توضیح دهم که `column` چگونه کار کرد، اما در واقع، آن متن را جدولی کرد.

فرض کنید شما می‌خواهید نه تنها متن خود را جدولی کنید، بلکه فقط ردیف‌هایی را که "Ok" دارند نمایش دهید. شما می‌دانید که `awk` می‌تواند این کار را به راحتی انجام دهد. شما می‌توانید این کار را به جای آن انجام دهید:

```shell
!}column -t -s "|" | awk 'NR > 1 && /Ok/ {print $0}'
```

نتیجه:

```shell
02  Kitten  Ok
03  Bunny   Ok
```

عالی! عملگر دستور خارجی همچنین می‌تواند از لوله (`|`) استفاده کند.

این قدرت ترکیب‌پذیری Vim است. هرچه بیشتر افعال، حرکات و دستورات ترمینال خود را بشناسید، توانایی شما برای ترکیب اقدامات پیچیده *افزایش* می‌یابد.

فرض کنید شما فقط چهار حرکت، `w, $, }, G` و فقط یک عملگر، `d` را می‌دانید. شما می‌توانید ۸ عمل انجام دهید: *حرکت* ۴ روش مختلف (`w, $, }, G`) و *حذف* ۴ هدف مختلف (`dw, d$, d}, dG`). سپس یک روز شما در مورد عملگر بزرگ (`gU`) یاد می‌گیرید. شما نه تنها یک توانایی جدید به ابزار Vim خود اضافه کرده‌اید، بلکه *چهار* توانایی: `gUw, gU$, gU}, gUG`. این باعث می‌شود که ۱۲ ابزار در ابزار Vim شما باشد. هر دانش جدید یک ضرب‌کننده به توانایی‌های فعلی شما است. اگر شما ۱۰ حرکت و ۵ عملگر بدانید، ۶۰ حرکت (۵۰ عملیات + ۱۰ حرکت) در زرادخانه خود دارید. Vim یک حرکت شماره خط (`nG`) دارد که به شما `n` حرکت می‌دهد، جایی که `n` تعداد خطوطی است که در فایل شما وجود دارد (برای رفتن به خط ۵، دستور `5G` را اجرا کنید). حرکت جستجو (`/`) تقریباً به شما تعداد نامحدودی حرکت می‌دهد زیرا می‌توانید برای هر چیزی جستجو کنید. عملگر دستور خارجی (`!`) به شما به تعداد دستورات ترمینال که می‌دانید، ابزار فیلتر می‌دهد. با استفاده از ابزاری ترکیب‌پذیر مانند Vim، هر چیزی که می‌دانید می‌تواند به هم متصل شود تا عملیات با پیچیدگی فزاینده انجام شود. هرچه بیشتر بدانید، قدرتمندتر می‌شوید.

این رفتار ترکیب‌پذیر فلسفه یونیکس را منعکس می‌کند: *یک کار را به خوبی انجام دهید*. یک عملگر یک کار دارد: Y را انجام دهید. یک حرکت یک کار دارد: به X بروید. با ترکیب یک عملگر با یک حرکت، به طور قابل پیش‌بینی YX را به دست می‌آورید: Y را بر روی X انجام دهید.

حرکات و عملگرها قابل گسترش هستند. شما می‌توانید حرکات و عملگرهای سفارشی ایجاد کنید تا به کمربند ابزار Vim خود اضافه کنید. پلاگین [`vim-textobj-user`](https://github.com/kana/vim-textobj-user) به شما اجازه می‌دهد تا اشیاء متنی خود را ایجاد کنید. همچنین شامل یک [فهرست](https://github.com/kana/vim-textobj-user/wiki) از اشیاء متنی سفارشی ساخته شده توسط کاربران است.

## گرامر Vim را به روش هوشمند یاد بگیرید

شما اکنون در مورد قاعده گرامری Vim یاد گرفتید: `فعل + اسم`. یکی از بزرگ‌ترین لحظات "آها!" من در Vim زمانی بود که تازه در مورد عملگر بزرگ (`gU`) یاد گرفته بودم و می‌خواستم کلمه فعلی را بزرگ کنم، به طور *غریزی* `gUiw` را اجرا کردم و کار کرد! کلمه بزرگ شد. در آن لحظه، من بالاخره شروع به درک Vim کردم. امید من این است که شما نیز به زودی لحظه "آها!" خود را داشته باشید، اگر هنوز نداشته‌اید.

هدف این فصل این است که الگوی `فعل + اسم` را در Vim به شما نشان دهد تا شما یادگیری Vim را مانند یادگیری یک زبان جدید به جای حفظ کردن هر ترکیب دستوری نزدیک کنید.

الگو را یاد بگیرید و پیامدهای آن را درک کنید. این روش هوشمندانه برای یادگیری است.