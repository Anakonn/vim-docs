---
description: این سند به شما آموزش می‌دهد که چگونه از دستور نقطه (dot command) در ویم
  برای تکرار تغییرات قبلی به‌طور آسان و مؤثر استفاده کنید.
title: Ch07. the Dot Command
---

به طور کلی، شما باید سعی کنید هر زمان که ممکن است از انجام دوباره کاری که قبلاً انجام داده‌اید، خودداری کنید. در این فصل، شما یاد خواهید گرفت که چگونه از دستور نقطه برای به راحتی دوباره انجام دادن تغییر قبلی استفاده کنید. این یک دستور چندمنظوره برای کاهش تکرارهای ساده است.

## استفاده

دقیقاً مانند نامش، شما می‌توانید با فشار دادن کلید نقطه (`.`) از دستور نقطه استفاده کنید.

به عنوان مثال، اگر می‌خواهید تمام "let" را با "const" در عبارات زیر جایگزین کنید:

```shell
let one = "1";
let two = "2";
let three = "3";
```

- با `/let` جستجو کنید تا به تطابق بروید.
- با `cwconst<Esc>` "let" را با "const" جایگزین کنید.
- با `n` برای پیدا کردن تطابق بعدی با استفاده از جستجوی قبلی حرکت کنید.
- آنچه را که تازه انجام داده‌اید با دستور نقطه (`.`) تکرار کنید.
- ادامه دهید تا زمانی که هر کلمه را جایگزین کنید با فشار دادن `n . n .`.

در اینجا دستور نقطه توالی `cwconst<Esc>` را تکرار کرد. این شما را از تایپ هشت کلید در عوض فقط یک کلید نجات داد.

## تغییر چیست؟

اگر به تعریف دستور نقطه (`:h .`) نگاه کنید، می‌گوید که دستور نقطه آخرین تغییر را تکرار می‌کند. تغییر چیست؟

هر بار که محتوای بافر فعلی را به‌روزرسانی (اضافه، ویرایش یا حذف) می‌کنید، یک تغییر ایجاد می‌کنید. استثناها به‌روزرسانی‌هایی هستند که توسط دستورات خط فرمان (دستورات شروع شده با `:`) انجام می‌شوند که به عنوان یک تغییر حساب نمی‌شوند.

در مثال اول، `cwconst<Esc>` تغییر بود. حال فرض کنید این متن را دارید:

```shell
pancake, potatoes, fruit-juice,
```

برای حذف متن از ابتدای خط تا وقوع بعدی ویرگول، ابتدا تا ویرگول حذف کنید، سپس دو بار با `df,..` تکرار کنید.

بیایید یک مثال دیگر را امتحان کنیم:

```shell
pancake, potatoes, fruit-juice,
```

این بار، وظیفه شما حذف ویرگول است، نه اقلام صبحانه. با قرار دادن نشانگر در ابتدای خط، به اولین ویرگول بروید، آن را حذف کنید، سپس دو بار دیگر با `f,x..` تکرار کنید. آسان است، درست است؟ صبر کنید، کار نکرد! چرا؟

یک تغییر حرکات را شامل نمی‌شود زیرا محتوای بافر را به‌روزرسانی نمی‌کند. دستور `f,x` شامل دو عمل بود: دستور `f,` برای حرکت نشانگر به "," و `x` برای حذف یک کاراکتر. فقط دومی، `x`، باعث ایجاد تغییر شد. این را با `df,` از مثال قبلی مقایسه کنید. در آن، `f,` یک دستور به اپراتور حذف `d` است، نه حرکتی برای حرکت نشانگر. `f,` در `df,` و `f,x` دو نقش بسیار متفاوت دارند.

بیایید آخرین کار را تمام کنیم. پس از اجرای `f,` سپس `x`، با `;` به ویرگول بعدی بروید تا آخرین `f` را تکرار کنید. در نهایت، از `.` برای حذف کاراکتر زیر نشانگر استفاده کنید. `; . ; .` را تکرار کنید تا همه چیز حذف شود. فرمان کامل `f,x;.;.` است.

بیایید یکی دیگر را امتحان کنیم:

```shell
pancake
potatoes
fruit-juice
```

بیایید یک ویرگول در انتهای هر خط اضافه کنیم. از خط اول شروع کنید، `A,<Esc>j` را انجام دهید. تا به حال، متوجه شده‌اید که `j` تغییر ایجاد نمی‌کند. تغییر در اینجا فقط `A,` است. شما می‌توانید حرکت کنید و تغییر را با `j . j .` تکرار کنید. فرمان کامل `A,<Esc>j.j.` است.

هر عملی از لحظه‌ای که شما دستور وارد کردن (`A`) را فشار می‌دهید تا زمانی که از دستور وارد کردن خارج می‌شوید (`<Esc>`) به عنوان یک تغییر در نظر گرفته می‌شود.

## تکرار چند خطی

فرض کنید این متن را دارید:

```shell
let one = "1";
let two = "2";
let three = "3";
const foo = "bar';
let four = "4";
let five = "5";
let six = "6";
let seven = "7";
let eight = "8";
let nine = "9";
```

هدف شما حذف تمام خطوط به جز خط "foo" است. ابتدا با `d2j` سه خط اول را حذف کنید، سپس به خط زیر خط "foo" بروید. در خط بعدی، از دستور نقطه دو بار استفاده کنید. فرمان کامل `d2jj..` است.

در اینجا تغییر `d2j` بود. در این زمینه، `2j` یک حرکت نبود، بلکه بخشی از اپراتور حذف بود.

بیایید به یک مثال دیگر نگاه کنیم:

```shell
zlet zzone = "1";
zlet zztwo = "2";
zlet zzthree = "3";
let four = "4";
```

بیایید تمام zها را حذف کنیم. از اولین کاراکتر در خط اول شروع کنید، فقط اولین z را از سه خط اول با حالت بصری بلوکی (`Ctrl-Vjj`) انتخاب کنید. اگر با حالت بصری بلوکی آشنا نیستید، در فصل بعدی به آن می‌پردازم. هنگامی که سه z را به صورت بصری انتخاب کردید، آنها را با اپراتور حذف (`d`) حذف کنید. سپس به کلمه بعدی (`w`) بروید تا به z بعدی برسید. تغییر را دو بار دیگر تکرار کنید (`..`). فرمان کامل `Ctrl-vjjdw..` است.

زمانی که یک ستون از سه z (`Ctrl-vjjd`) را حذف کردید، به عنوان یک تغییر حساب شد. عملیات حالت بصری می‌تواند برای هدف قرار دادن چند خط به عنوان بخشی از یک تغییر استفاده شود.

## شامل کردن یک حرکت در یک تغییر

بیایید به مثال اول در این فصل برگردیم. به یاد داشته باشید که دستور `/letcwconst<Esc>` به دنبال `n . n .` تمام "let" را با "const" در عبارات زیر جایگزین کرد:

```shell
let one = "1";
let two = "2";
let three = "3";
```

یک راه سریع‌تر برای انجام این کار وجود دارد. پس از جستجوی `/let`، `cgnconst<Esc>` را اجرا کنید سپس `. .`.

`gn` یک حرکت است که به جلو برای آخرین الگوی جستجو (در این مورد، `/let`) جستجو می‌کند و به طور خودکار یک هایلایت بصری انجام می‌دهد. برای جایگزینی وقوع بعدی، دیگر نیازی به حرکت و تکرار تغییر ( `n . n .`) ندارید، بلکه فقط کافی است تکرار کنید (`. .`). دیگر نیازی به استفاده از حرکات جستجو ندارید زیرا جستجوی تطابق بعدی اکنون بخشی از تغییر است!

هنگام ویرایش، همیشه به دنبال حرکاتی باشید که می‌توانند چندین کار را به طور همزمان انجام دهند، مانند `gn` هر زمان که ممکن است.

## یادگیری دستور نقطه به روش هوشمند

قدرت دستور نقطه از تبادل چندین کلید برای یک کلید ناشی می‌شود. احتمالاً استفاده از دستور نقطه برای عملیات تک کلیدی مانند `x` یک تبادل سودآور نیست. اگر تغییر آخر شما نیاز به یک عملیات پیچیده مانند `cgnconst<Esc>` دارد، دستور نقطه نه کلید را به یک کلید کاهش می‌دهد، که یک معامله بسیار سودآور است.

هنگام ویرایش، به تکرارپذیری فکر کنید. به عنوان مثال، اگر نیاز به حذف سه کلمه بعدی داشته باشم، آیا استفاده از `d3w` اقتصادی‌تر است یا انجام `dw` سپس دو بار `.`؟ آیا دوباره یک کلمه را حذف خواهید کرد؟ اگر چنین است، پس منطقی است که از `dw` استفاده کنید و آن را چندین بار تکرار کنید به جای `d3w` زیرا `dw` نسبت به `d3w` قابل استفاده‌تر است.

دستور نقطه یک دستور چندمنظوره برای خودکارسازی تغییرات تک است. در فصل بعدی، شما یاد خواهید گرفت که چگونه اقدامات پیچیده‌تر را با ماکروهای Vim خودکار کنید. اما ابتدا، بیایید درباره ثبت‌کننده‌ها برای ذخیره و بازیابی متن یاد بگیریم.