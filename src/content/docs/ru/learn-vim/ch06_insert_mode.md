---
description: В этом документе рассматриваются функции режима вставки в Vim и способы
  повышения эффективности набора текста с помощью различных команд.
title: Ch06. Insert Mode
---

Режим вставки является режимом по умолчанию во многих текстовых редакторах. В этом режиме то, что вы вводите, — это то, что вы получаете.

Тем не менее, это не означает, что нечего учить. Режим вставки Vim содержит много полезных функций. В этой главе вы узнаете, как использовать эти функции режима вставки в Vim для повышения вашей эффективности при наборе текста.

## Способы перехода в режим вставки

Существует множество способов перейти в режим вставки из нормального режима. Вот некоторые из них:

```shell
i    Вставить текст перед курсором
I    Вставить текст перед первым ненулевым символом строки
a    Добавить текст после курсора
A    Добавить текст в конец строки
o    Начать новую строку под курсором и вставить текст
O    Начать новую строку над курсором и вставить текст
s    Удалить символ под курсором и вставить текст
S    Удалить текущую строку и вставить текст, синоним для "cc"
gi   Вставить текст в том же месте, где остановился последний режим вставки
gI   Вставить текст в начале строки (колонка 1)
```

Обратите внимание на шаблон строчных / заглавных букв. Для каждой строчной команды есть заглавная. Если вы новичок, не беспокойтесь, если не запомнили весь список выше. Начните с `i` и `o`. Их должно быть достаточно, чтобы начать. Постепенно изучайте больше со временем.

## Разные способы выхода из режима вставки

Существует несколько различных способов вернуться в нормальный режим, находясь в режиме вставки:

```shell
<Esc>     Выход из режима вставки и переход в нормальный режим
Ctrl-[    Выход из режима вставки и переход в нормальный режим
Ctrl-C    Как Ctrl-[ и <Esc>, но не проверяет на сокращения
```

Я нахожу клавишу `<Esc>` слишком далекой для достижения, поэтому я перенастроил свою клавиатуру `<Caps-Lock>`, чтобы она работала как `<Esc>`. Если вы посмотрите на клавиатуру Bill Joy's ADM-3A (создателя Vi), вы увидите, что клавиша `<Esc>` не расположена в далеком верхнем левом углу, как на современных клавиатурах, а слева от клавиши `q`. Вот почему я считаю, что имеет смысл перенастроить `<Caps lock>` на `<Esc>`.

Еще одна распространенная практика, которую я видел у пользователей Vim, — это перенастройка `<Esc>` на `jj` или `jk` в режиме вставки. Если вы предпочитаете этот вариант, добавьте одну из этих строк (или обе) в ваш файл vimrc.

```shell
inoremap jj <Esc>
inoremap jk <Esc>
```

## Повторение режима вставки

Вы можете передать параметр количества перед входом в режим вставки. Например:

```shell
10i
```

Если вы напечатаете "hello world!" и выйдете из режима вставки, Vim повторит текст 10 раз. Это будет работать с любым методом режима вставки (например: `10I`, `11a`, `12o`).

## Удаление фрагментов в режиме вставки

Когда вы делаете ошибку при наборе текста, может быть неудобно постоянно нажимать `<Backspace>`. Возможно, имеет смысл перейти в нормальный режим и удалить вашу ошибку. Вы также можете удалить несколько символов за раз, находясь в режиме вставки.

```shell
Ctrl-h    Удалить один символ
Ctrl-w    Удалить одно слово
Ctrl-u    Удалить всю строку
```

## Вставка из регистра

Регистры Vim могут хранить тексты для будущего использования. Чтобы вставить текст из любого именованного регистра, находясь в режиме вставки, введите `Ctrl-R` плюс символ регистра. Существует множество символов, которые вы можете использовать, но в этом разделе давайте рассмотрим только именованные регистры (a-z).

Чтобы увидеть это в действии, сначала вам нужно вырезать слово в регистр a. Переместите курсор на любое слово. Затем введите:

```shell
"ayiw
```

- `"a` говорит Vim, что цель вашего следующего действия будет записана в регистр a.
- `yiw` вырезает внутреннее слово. Ознакомьтесь с главой о грамматике Vim для освежения памяти.

Регистру a теперь принадлежит слово, которое вы только что вырезали. Находясь в режиме вставки, чтобы вставить текст, хранящийся в регистре a:

```shell
Ctrl-R a
```

В Vim существует несколько типов регистров. Я расскажу о них более подробно в следующей главе.

## Прокрутка

Вы знали, что можно прокручивать, находясь в режиме вставки? Находясь в режиме вставки, если вы перейдете в подрежим `Ctrl-X`, вы сможете выполнять дополнительные операции. Прокрутка — одна из них.

```shell
Ctrl-X Ctrl-Y    Прокрутить вверх
Ctrl-X Ctrl-E    Прокрутить вниз
```

## Автозаполнение

Как упоминалось выше, если вы нажмете `Ctrl-X` из режима вставки, Vim перейдет в подрежим. Вы можете выполнять автозаполнение текста, находясь в этом подрежиме режима вставки. Хотя это не так хорошо, как [intellisense](https://code.visualstudio.com/docs/editor/intellisense) или любой другой протокол языка (LSP), но для функции, доступной прямо "из коробки", это очень способная функция.

Вот несколько полезных команд автозаполнения, чтобы начать:

```shell
Ctrl-X Ctrl-L	   Вставить целую строку
Ctrl-X Ctrl-N	   Вставить текст из текущего файла
Ctrl-X Ctrl-I	   Вставить текст из включенных файлов
Ctrl-X Ctrl-F	   Вставить имя файла
```

Когда вы вызываете автозаполнение, Vim отображает всплывающее окно. Чтобы перемещаться вверх и вниз по всплывающему окну, используйте `Ctrl-N` и `Ctrl-P`.

У Vim также есть два ярлыка автозаполнения, которые не требуют подрежима `Ctrl-X`:

```shell
Ctrl-N             Найти следующее совпадение слова
Ctrl-P             Найти предыдущее совпадение слова
```

В общем, Vim смотрит на текст во всех доступных буферах для источника автозаполнения. Если у вас открыт буфер со строкой, которая говорит "Шоколадные пончики — лучшие":
- Когда вы вводите "Choco" и нажимаете `Ctrl-X Ctrl-L`, он совпадет и выведет всю строку.
- Когда вы вводите "Choco" и нажимаете `Ctrl-P`, он совпадет и выведет слово "Шоколад".

Автозаполнение — это обширная тема в Vim. Это только верхушка айсберга. Чтобы узнать больше, ознакомьтесь с `:h ins-completion`.

## Выполнение команды нормального режима

Вы знали, что Vim может выполнять команду нормального режима, находясь в режиме вставки?

Находясь в режиме вставки, если вы нажмете `Ctrl-O`, вы перейдете в подрежим вставки-нормала. Если вы посмотрите на индикатор режима в нижнем левом углу, обычно вы увидите `-- INSERT --`, но нажатие `Ctrl-O` изменит его на `-- (insert) --`. В этом режиме вы можете выполнить *одну* команду нормального режима. Вот некоторые вещи, которые вы можете сделать:

**Центрирование и прыжки**

```shell
Ctrl-O zz       Центрировать окно
Ctrl-O H/M/L    Прыжок к верхней/средней/нижней части окна
Ctrl-O 'a       Прыжок к метке a
```

**Повторение текста**

```shell
Ctrl-O 100ihello    Вставить "hello" 100 раз
```

**Выполнение команд терминала**

```shell
Ctrl-O !! curl https://google.com    Выполнить curl
Ctrl-O !! pwd                        Выполнить pwd
```

**Быстрое удаление**

```shell
Ctrl-O dtz    Удалить от текущего местоположения до буквы "z"
Ctrl-O D      Удалить от текущего местоположения до конца строки
```

## Учите режим вставки умным способом

Если вы, как и я, пришли из другого текстового редактора, может возникнуть искушение оставаться в режиме вставки. Однако оставаться в режиме вставки, когда вы не вводите текст, является антишаблоном. Развивайте привычку переходить в нормальный режим, когда ваши пальцы не вводят новый текст.

Когда вам нужно вставить текст, сначала спросите себя, существует ли этот текст уже. Если да, попробуйте вырезать или переместить этот текст вместо того, чтобы вводить его. Если вам нужно использовать режим вставки, посмотрите, можете ли вы автозаполнить этот текст, когда это возможно. Избегайте ввода одного и того же слова более одного раза, если это возможно.