---
description: تستعرض هذه الوثيقة طرقًا متعددة لتحرير الملفات في فيم، بما في ذلك أوامر
  مثل `argdo` و`cdo`، مما يسهل تحديث النصوص عبر ملفات متعددة.
title: Ch21. Multiple File Operations
---

كونك قادرًا على التحديث في ملفات متعددة هو أداة تحرير مفيدة أخرى يجب أن تمتلكها. في وقت سابق، تعلمت كيفية تحديث نصوص متعددة باستخدام `cfdo`. في هذا الفصل، ستتعلم الطرق المختلفة التي يمكنك من خلالها تحرير ملفات متعددة في Vim.

## طرق مختلفة لتنفيذ أمر في ملفات متعددة

يمتلك Vim ثماني طرق لتنفيذ الأوامر عبر ملفات متعددة:
- قائمة الحجة (`argdo`)
- قائمة المخزن المؤقت (`bufdo`)
- قائمة النوافذ (`windo`)
- قائمة التبويبات (`tabdo`)
- قائمة التصحيح السريع (`cdo`)
- قائمة التصحيح السريع حسب الملف (`cfdo`)
- قائمة المواقع (`ldo`)
- قائمة المواقع حسب الملف (`lfdo`)

من الناحية العملية، من المحتمل أن تستخدم واحدة أو اثنتين في معظم الأوقات (أنا شخصيًا أستخدم `cdo` و `argdo` أكثر من الآخرين)، لكن من الجيد أن تتعلم عن جميع الخيارات المتاحة واستخدام تلك التي تتناسب مع أسلوب تحريرك.

قد يبدو تعلم ثمانية أوامر أمرًا شاقًا. لكن في الواقع، تعمل هذه الأوامر بشكل مشابه. بعد تعلم واحد، سيكون تعلم البقية أسهل. جميعها تشترك في نفس الفكرة الكبيرة: قم بإنشاء قائمة بفئاتها المعنية ثم مرر لها الأمر الذي تريد تشغيله.

## قائمة الحجة

قائمة الحجة هي القائمة الأساسية. تقوم بإنشاء قائمة من الملفات. لإنشاء قائمة من file1 و file2 و file3، يمكنك تشغيل:

```shell
:args file1 file2 file3
```

يمكنك أيضًا تمريرها باستخدام حرف البدل (`*`)، لذا إذا كنت تريد إنشاء قائمة بجميع ملفات `.js` في الدليل الحالي، قم بتشغيل:

```shell
:args *.js
```

إذا كنت تريد إنشاء قائمة بجميع ملفات Javascript التي تبدأ بـ "a" في الدليل الحالي، قم بتشغيل:

```shell
:args a*.js
```

يتطابق حرف البدل مع واحد أو أكثر من أي حرف اسم ملف في الدليل الحالي، لكن ماذا لو كنت بحاجة إلى البحث بشكل متكرر في أي دليل؟ يمكنك استخدام حرف البدل المزدوج (`**`). للحصول على جميع ملفات Javascript داخل الأدلة الموجودة في موقعك الحالي، قم بتشغيل:

```shell
:args **/*.js
```

بمجرد تشغيل أمر `args`، سيتم تبديل المخزن المؤقت الحالي إلى العنصر الأول في القائمة. لعرض قائمة الملفات التي أنشأتها للتو، قم بتشغيل `:args`. بمجرد أن تقوم بإنشاء قائمتك، يمكنك التنقل بينها. سيضعك `:first` على العنصر الأول في القائمة. سيضعك `:last` على آخر عنصر في القائمة. للتنقل في القائمة للأمام ملفًا واحدًا في كل مرة، قم بتشغيل `:next`. للتنقل في القائمة للخلف ملفًا واحدًا في كل مرة، قم بتشغيل `:prev`. للتنقل للأمام / للخلف ملفًا واحدًا في كل مرة وحفظ التغييرات، قم بتشغيل `:wnext` و `:wprev`. هناك المزيد من أوامر التنقل. تحقق من `:h arglist` لمزيد من المعلومات.

قائمة الحجة مفيدة إذا كنت بحاجة إلى استهداف نوع معين من الملفات أو عدد قليل من الملفات. ربما تحتاج إلى تحديث جميع "donut" إلى "pancake" داخل جميع ملفات `yml`، يمكنك القيام بذلك:

```shell
:args **/*.yml
:argdo %s/donut/pancake/g | update
```

إذا قمت بتشغيل أمر `args` مرة أخرى، فسيتم استبدال القائمة السابقة. على سبيل المثال، إذا كنت قد قمت بتشغيل:

```shell
:args file1 file2 file3
```

بافتراض أن هذه الملفات موجودة، لديك الآن قائمة بـ `file1` و `file2` و `file3`. ثم تقوم بتشغيل هذا:

```shell
:args file4 file5
```

ستستبدل قائمتك الأولية من `file1` و `file2` و `file3` بـ `file4` و `file5`. إذا كان لديك `file1` و `file2` و `file3` في قائمة الحجة الخاصة بك وتريد *إضافة* `file4` و `file5` إلى قائمة ملفاتك الأولية، استخدم أمر `:arga`. قم بتشغيل:

```shell
:arga file4 file5
```

الآن لديك `file1` و `file2` و `file3` و `file4` و `file5` في قائمة الحجة الخاصة بك.

إذا قمت بتشغيل `:arga` بدون أي حجة، سيضيف Vim المخزن المؤقت الحالي إلى قائمة الحجة الحالية. إذا كان لديك بالفعل `file1` و `file2` و `file3` في قائمة الحجة الخاصة بك وكان المخزن المؤقت الحالي على `file5`، فإن تشغيل `:arga` يضيف `file5` إلى القائمة.

بمجرد أن يكون لديك القائمة، يمكنك تمريرها مع أي أوامر سطر أوامر من اختيارك. لقد رأيت كيف يتم ذلك مع الاستبدال (`:argdo %s/donut/pancake/g`). بعض الأمثلة الأخرى:
- لحذف جميع الأسطر التي تحتوي على "dessert" عبر قائمة الحجة، قم بتشغيل `:argdo g/dessert/d`.
- لتنفيذ الماكرو a (بافتراض أنك قمت بتسجيل شيء ما في الماكرو a) عبر قائمة الحجة، قم بتشغيل `:argdo norm @a`.
- لكتابة "hello " متبوعة باسم الملف في السطر الأول، قم بتشغيل `:argdo 0put='hello ' .. @:`.

بمجرد الانتهاء، لا تنسَ حفظها باستخدام `:update`.

أحيانًا تحتاج إلى تشغيل الأوامر فقط على العناصر الأولى n من قائمة الحجة. إذا كان هذا هو الحال، فقط مرر إلى أمر `argdo` عنوانًا. على سبيل المثال، لتشغيل أمر الاستبدال فقط على العناصر الثلاثة الأولى من القائمة، قم بتشغيل `:1,3argdo %s/donut/pancake/g`.

## قائمة المخزن المؤقت

ستتم إنشاء قائمة المخزن المؤقت بشكل عضوي عندما تقوم بتحرير ملفات جديدة لأنه في كل مرة تقوم فيها بإنشاء ملف جديد / فتح ملف، يقوم Vim بحفظه في مخزن مؤقت (ما لم تقم بحذفه صراحة). لذا إذا كنت قد فتحت بالفعل 3 ملفات: `file1.rb file2.rb file3.rb`، لديك بالفعل 3 عناصر في قائمة المخزن المؤقت الخاصة بك. لعرض قائمة المخزن المؤقت، قم بتشغيل `:buffers` (بدلاً من ذلك: `:ls` أو `:files`). للتنقل للأمام والخلف، استخدم `:bnext` و `:bprev`. للذهاب إلى المخزن المؤقت الأول والأخير من القائمة، استخدم `:bfirst` و `:blast` (هل تستمتع الآن؟ :D).

بالمناسبة، إليك خدعة مخزن مؤقت رائعة غير مرتبطة بهذا الفصل: إذا كان لديك عدد من العناصر في قائمة المخزن المؤقت الخاصة بك، يمكنك عرض جميعها باستخدام `:ball` (مخزن مؤقت جميعًا). يقوم أمر `ball` بعرض جميع المخازن المؤقتة أفقيًا. لعرضها عموديًا، قم بتشغيل `:vertical ball`.

بالعودة إلى الموضوع، فإن الآلية لتشغيل العمليات عبر جميع المخازن المؤقتة مشابهة لقائمة الحجة. بمجرد أن تقوم بإنشاء قائمة المخزن المؤقت، تحتاج فقط إلى إضافة الأمر (أو الأوامر) التي تريد تشغيلها مع `:bufdo` بدلاً من `:argdo`. لذا إذا كنت تريد استبدال جميع "donut" بـ "pancake" عبر جميع المخازن المؤقتة ثم حفظ التغييرات، قم بتشغيل `:bufdo %s/donut/pancake/g | update`.

## قائمة النوافذ والتبويبات

قائمتا النوافذ والتبويبات مشابهتان أيضًا لقائمة الحجة وقائمة المخزن المؤقت. الاختلافات الوحيدة هي سياقها وبنيتها.

تتم العمليات على النوافذ على كل نافذة مفتوحة وتتم باستخدام `:windo`. تتم العمليات على التبويبات على كل تبويب قمت بفتحه وتتم باستخدام `:tabdo`. للمزيد، تحقق من `:h list-repeat` و `:h :windo` و `:h :tabdo`.

على سبيل المثال، إذا كان لديك ثلاث نوافذ مفتوحة (يمكنك فتح نوافذ جديدة باستخدام `Ctrl-W v` لنافذة عمودية و `Ctrl-W s` لنافذة أفقية) وقمت بتشغيل `:windo 0put ='hello' . @%`، سيقوم Vim بإخراج "hello" + اسم الملف إلى جميع النوافذ المفتوحة.

## قائمة التصحيح السريع

في الفصول السابقة (Ch3 و Ch19)، تحدثت عن التصحيحات السريعة. للتصحيح السريع العديد من الاستخدامات. تستخدم العديد من الإضافات الشهيرة التصحيحات السريعة، لذا من الجيد قضاء المزيد من الوقت لفهمها.

إذا كنت جديدًا على Vim، قد يكون التصحيح السريع مفهومًا جديدًا. في الأيام القديمة عندما كان عليك فعليًا تجميع الكود الخاص بك، خلال مرحلة التجميع كنت ستواجه أخطاء. لعرض هذه الأخطاء، تحتاج إلى نافذة خاصة. هنا يأتي دور التصحيح السريع. عندما تقوم بتجميع الكود الخاص بك، يقوم Vim بعرض رسائل الخطأ في نافذة التصحيح السريع حتى تتمكن من إصلاحها لاحقًا. العديد من اللغات الحديثة لم تعد تتطلب تجميعًا صريحًا، لكن هذا لا يجعل التصحيح السريع غير ذي جدوى. في الوقت الحاضر، يستخدم الناس التصحيح السريع لأغراض متنوعة، مثل عرض مخرجات المحطة الافتراضية وتخزين نتائج البحث. دعنا نركز على الأخيرة، تخزين نتائج البحث.

بالإضافة إلى أوامر التجميع، تعتمد بعض أوامر Vim على واجهات التصحيح السريع. نوع واحد من الأوامر التي تستخدم التصحيحات السريعة بشكل كبير هي أوامر البحث. كل من `:vimgrep` و `:grep` تستخدم التصحيحات السريعة بشكل افتراضي.

على سبيل المثال، إذا كنت بحاجة إلى البحث عن "donut" في جميع ملفات Javascript بشكل متكرر، يمكنك تشغيل:

```shell
:vimgrep /donut/ **/*.js
```

يتم تخزين نتيجة البحث عن "donut" في نافذة التصحيح السريع. لرؤية نتائج المطابقة في نافذة التصحيح السريع، قم بتشغيل:

```shell
:copen
```

لإغلاقها، قم بتشغيل:

```shell
:cclose
```

للتنقل في قائمة التصحيح السريع للأمام والخلف، قم بتشغيل:

```shell
:cnext
:cprev
```

للذهاب إلى العنصر الأول والأخير في المطابقة، قم بتشغيل:

```shell
:cfirst
:clast
```

في وقت سابق، ذكرت أن هناك أمرين للتصحيح السريع: `cdo` و `cfdo`. كيف يختلفان؟ يقوم `cdo` بتنفيذ الأمر لكل عنصر في قائمة التصحيح السريع بينما يقوم `cfdo` بتنفيذ الأمر لكل *ملف* في قائمة التصحيح السريع.

دعني أوضح. افترض أنه بعد تشغيل أمر `vimgrep` أعلاه، وجدت:
- 1 نتيجة في `file1.js`
- 10 نتائج في `file2.js`

إذا قمت بتشغيل `:cfdo %s/donut/pancake/g`، فسيتم تشغيل `%s/donut/pancake/g` مرة واحدة في `file1.js` ومرة واحدة في `file2.js`. يتم تشغيله *بقدر ما هناك من ملفات في المطابقة.* نظرًا لوجود ملفين في النتائج، يقوم Vim بتنفيذ أمر الاستبدال مرة واحدة على `file1.js` ومرة أخرى على `file2.js`، على الرغم من وجود 10 مطابقة في الملف الثاني. `cfdo` تهتم فقط بعدد الملفات الإجمالية في قائمة التصحيح السريع.

إذا قمت بتشغيل `:cdo %s/donut/pancake/g`، فسيتم تشغيل `%s/donut/pancake/g` مرة واحدة في `file1.js` و *عشر مرات* في `file2.js`. يتم تشغيله بقدر ما هناك من عناصر فعلية في قائمة التصحيح السريع. نظرًا لوجود مطابقة واحدة فقط في `file1.js` و 10 مطابقة في `file2.js`، سيتم تشغيله بمجموع 11 مرة.

نظرًا لأنك قمت بتشغيل `%s/donut/pancake/g`، سيكون من المنطقي استخدام `cfdo`. لم يكن من المنطقي استخدام `cdo` لأنه سيقوم بتشغيل `%s/donut/pancake/g` عشر مرات في `file2.js` ( `%s` هو استبدال على مستوى الملف). تشغيل `%s` مرة واحدة لكل ملف يكفي. إذا كنت تستخدم `cdo`، سيكون من المنطقي تمريرها مع `s/donut/pancake/g` بدلاً من ذلك.

عند اتخاذ قرار بشأن استخدام `cfdo` أو `cdo`، فكر في نطاق الأمر الذي تمرره. هل هذا أمر على مستوى الملف (مثل `:%s` أو `:g`) أم هو أمر على مستوى السطر (مثل `:s` أو `:!`)؟

## قائمة المواقع

قائمة المواقع مشابهة لقائمة التصحيح السريع من حيث أن Vim يستخدم أيضًا نافذة خاصة لعرض الرسائل. الفرق بين قائمة التصحيح السريع وقائمة المواقع هو أنه في أي وقت، قد يكون لديك قائمة تصحيح سريع واحدة فقط، بينما يمكنك أن يكون لديك العديد من قوائم المواقع بقدر ما لديك من نوافذ.

افترض أنك قد فتحت نافذتين، نافذة تعرض `food.txt` وأخرى تعرض `drinks.txt`. من داخل `food.txt`، تقوم بتشغيل أمر بحث قائمة المواقع `:lvimgrep` (النسخة الخاصة بـ `:vimgrep`):

```shell
:lvim /bagel/ **/*.md
```

سيقوم Vim بإنشاء قائمة مواقع لجميع المطابقات الخاصة بالبحث عن bagel لذلك *النافذة* `food.txt`. يمكنك رؤية قائمة المواقع باستخدام `:lopen`. الآن انتقل إلى النافذة الأخرى `drinks.txt` وقم بتشغيل:

```shell
:lvimgrep /milk/ **/*.md
```

سيقوم Vim بإنشاء *قائمة مواقع منفصلة* تحتوي على جميع نتائج البحث عن milk لذلك *النافذة* `drinks.txt`.

لكل أمر موقع تقوم بتشغيله في كل نافذة، يقوم Vim بإنشاء قائمة مواقع مميزة. إذا كان لديك 10 نوافذ مختلفة، يمكنك أن يكون لديك ما يصل إلى 10 قوائم مواقع مختلفة. قارن هذا بقائمة التصحيح السريع حيث يمكنك أن يكون لديك واحدة فقط في أي وقت. إذا كان لديك 10 نوافذ مختلفة، فلا يزال لديك قائمة تصحيح سريع واحدة فقط.

معظم أوامر قائمة المواقع مشابهة لأوامر قائمة التصحيح السريع باستثناء أنها مسبوقة بـ `l-` بدلاً من ذلك. على سبيل المثال: `:lvimgrep` و `:lgrep` و `:lmake` مقابل `:vimgrep` و `:grep` و `:make`. للتلاعب بنافذة قائمة المواقع، مرة أخرى، تبدو الأوامر مشابهة لأوامر قائمة التصحيح السريع `:lopen` و `:lclose` و `:lfirst` و `:llast` و `:lnext` و `:lprev` مقابل `:copen` و `:cclose` و `:cfirst` و `:clast` و `:cnext` و `:cprev`.

أوامر قائمة المواقع المتعددة الملفات مشابهة أيضًا لأوامر قائمة التصحيح السريع المتعددة الملفات: `:ldo` و `:lfdo`. يقوم `:ldo` بتنفيذ أمر الموقع في كل قائمة مواقع بينما يقوم `:lfdo` بتنفيذ أمر قائمة المواقع لكل ملف في قائمة المواقع. للمزيد، تحقق من `:h location-list`.
## تشغيل عمليات متعددة الملفات في فيم

معرفة كيفية إجراء عملية متعددة الملفات هي مهارة مفيدة في التحرير. كلما احتجت إلى تغيير اسم متغير عبر ملفات متعددة، تريد تنفيذها دفعة واحدة. يحتوي فيم على ثمانية طرق مختلفة يمكنك القيام بذلك.

عمليًا، من المحتمل أنك لن تستخدم جميع الثمانية بالتساوي. ستنجذب نحو واحدة أو اثنتين. عندما تبدأ، اختر واحدة (أقترح شخصيًا البدء بقائمة المعاملات `:argdo`) واتقنها. بمجرد أن تشعر بالراحة مع واحدة، تعلم التالية. ستجد أن تعلم الثانية والثالثة والرابعة يصبح أسهل. كن مبدعًا. استخدمها مع تركيبات مختلفة. استمر في الممارسة حتى تتمكن من القيام بذلك بسهولة ودون الكثير من التفكير. اجعلها جزءًا من ذاكرة عضلاتك.

مع قول ذلك، لقد أتقنت تحرير فيم. مبروك!