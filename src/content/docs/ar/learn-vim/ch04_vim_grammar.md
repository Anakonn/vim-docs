---
description: هذا الفصل يشرح بنية أوامر فيم بطريقة بسيطة، مما يساعدك على فهم كيفية
  "التحدث" بلغة فيم بسهولة وثقة.
title: Ch04. Vim Grammar
---

من السهل أن تشعر بالرهبة من تعقيد أوامر Vim. إذا رأيت مستخدمًا لـ Vim يقوم بـ `gUfV` أو `1GdG`، قد لا تعرف على الفور ما تفعله هذه الأوامر. في هذا الفصل، سأقوم بتفكيك الهيكل العام لأوامر Vim إلى قاعدة نحوية بسيطة.

هذا هو الفصل الأكثر أهمية في الدليل بأكمله. بمجرد أن تفهم الهيكل النحوي الأساسي، ستتمكن من "التحدث" إلى Vim. بالمناسبة، عندما أقول *لغة Vim* في هذا الفصل، لا أتحدث عن لغة Vimscript (لغة البرمجة المدمجة في Vim، ستتعلم ذلك في الفصول اللاحقة).

## كيفية تعلم لغة

أنا لست ناطقًا أصليًا باللغة الإنجليزية. تعلمت الإنجليزية عندما كنت في الثالثة عشرة من عمري عندما انتقلت إلى الولايات المتحدة. هناك ثلاث أشياء تحتاج إلى القيام بها لتعلم التحدث بلغة جديدة:

1. تعلم قواعد النحو.
2. زيادة المفردات.
3. الممارسة، الممارسة، الممارسة.

وبالمثل، للتحدث بلغة Vim، تحتاج إلى تعلم قواعد النحو، وزيادة المفردات، والممارسة حتى تتمكن من تنفيذ الأوامر دون تفكير.

## قاعدة النحو

هناك قاعدة نحوية واحدة فقط في لغة Vim:

```shell
فعل + اسم
```

هذا كل شيء!

هذا يشبه قول هذه العبارات الإنجليزية:

- *"تناول (فعل) دونات (اسم)"*
- *"ركل (فعل) كرة (اسم)"*
- *"تعلم (فعل) محرر Vim (اسم)"*

الآن تحتاج إلى بناء مفرداتك مع أفعال وأسماء Vim الأساسية.

## الأسماء (الحركات)

الأسماء هي حركات Vim. تُستخدم الحركات للتنقل في Vim. أدناه قائمة ببعض حركات Vim:

```shell
h    يسار
j    أسفل
k    أعلى
l    يمين
w    الانتقال للأمام إلى بداية الكلمة التالية
}    القفز إلى الفقرة التالية
$    الذهاب إلى نهاية السطر
```

ستتعلم المزيد عن الحركات في الفصل التالي، لذا لا تقلق كثيرًا إذا لم تفهم بعضها.

## الأفعال (العوامل)

وفقًا لـ `:h operator`، يحتوي Vim على 16 عاملًا. ومع ذلك، من تجربتي، فإن تعلم هذه 3 عوامل يكفي لـ 80% من احتياجاتي التحريرية:

```shell
y    نسخ النص (نسخ)
d    حذف النص وحفظه في السجل
c    حذف النص، حفظه في السجل، وبدء وضع الإدخال
```

بالمناسبة، بعد أن تقوم بنسخ نص، يمكنك لصقه باستخدام `p` (بعد المؤشر) أو `P` (قبل المؤشر).

## الفعل والاسم

الآن بعد أن عرفت الأسماء والأفعال الأساسية، دعنا نطبق قاعدة النحو، الفعل + الاسم! لنفترض أن لديك هذا التعبير:

```javascript
const learn = "vim";
```

- لنسخ كل شيء من موقعك الحالي إلى نهاية السطر: `y$`.
- لحذف من موقعك الحالي إلى بداية الكلمة التالية: `dw`.
- لتغيير من موقعك الحالي إلى نهاية الفقرة الحالية، قل `c}`.

تقبل الحركات أيضًا عدد العد كوسائط (سأناقش هذا في الفصل التالي). إذا كنت بحاجة للذهاب لأعلى 3 أسطر، بدلاً من الضغط على `k` 3 مرات، يمكنك القيام بـ `3k`. يعمل العد مع قواعد نحوية Vim.
- لنسخ حرفين إلى اليسار: `y2h`.
- لحذف الكلمتين التاليتين: `d2w`.
- لتغيير السطرين التاليين: `c2j`.

في الوقت الحالي، قد تضطر إلى التفكير طويلًا وصعبًا لتنفيذ حتى أمر بسيط. أنت لست وحدك. عندما بدأت لأول مرة، واجهت صعوبات مماثلة لكنني أصبحت أسرع مع الوقت. كذلك ستفعل. التكرار، التكرار، التكرار.

كملحوظة جانبية، العمليات الخطية (العمليات التي تؤثر على السطر بالكامل) هي عمليات شائعة في تحرير النصوص. بشكل عام، عن طريق كتابة أمر عامل مرتين، يقوم Vim بتنفيذ عملية خطية لهذا الإجراء. على سبيل المثال، `dd`، `yy`، و `cc` تقوم بـ **الحذف**، **النسخ**، و **التغيير** على السطر بالكامل. جرب هذا مع عوامل أخرى!

هذا رائع حقًا. أرى نمطًا هنا. لكنني لم أنته بعد. يحتوي Vim على نوع آخر من الأسماء: كائنات النص.

## المزيد من الأسماء (كائنات النص)

تخيل أنك في مكان ما داخل زوج من الأقواس مثل `(hello Vim)` وتحتاج إلى حذف العبارة بالكامل داخل الأقواس. كيف يمكنك القيام بذلك بسرعة؟ هل هناك طريقة لحذف "المجموعة" التي أنت داخلها؟

الإجابة هي نعم. غالبًا ما تأتي النصوص منظمة. غالبًا ما تحتوي على أقواس، اقتباسات، أقواس مربعة، أقواس معقوفة، والمزيد. يحتوي Vim على طريقة لالتقاط هذه البنية باستخدام كائنات النص.

تُستخدم كائنات النص مع العوامل. هناك نوعان من كائنات النص: كائنات النص الداخلية والخارجية.

```shell
i + object    كائن نص داخلي
a + object    كائن نص خارجي
```

يختار كائن النص الداخلي الكائن داخل *بدون* المساحة البيضاء أو الكائنات المحيطة. يختار كائن النص الخارجي الكائن داخل *بما في ذلك* المساحة البيضاء أو الكائنات المحيطة. بشكل عام، يختار كائن النص الخارجي دائمًا نصًا أكثر من كائن النص الداخلي. إذا كان المؤشر لديك في مكان ما داخل الأقواس في التعبير `(hello Vim)`:
- لحذف النص داخل الأقواس دون حذف الأقواس: `di(`.
- لحذف الأقواس والنص داخلها: `da(`.

لننظر إلى مثال مختلف. لنفترض أن لديك هذه الدالة في Javascript ومؤشرك على "H" في "Hello":

```javascript
const hello = function() {
  console.log("Hello Vim");
  return true;
}
```

- لحذف "Hello Vim" بالكامل: `di(`.
- لحذف محتوى الدالة (المحيط بـ `{}`): `di{`.
- لحذف سلسلة "Hello": `diw`.

كائنات النص قوية لأنك تستطيع استهداف كائنات مختلفة من موقع واحد. يمكنك حذف الكائنات داخل الأقواس، كتلة الدالة، أو الكلمة الحالية. ذهنيًا، عندما ترى `di(`، `di{`، و `diw`، تحصل على فكرة جيدة جدًا عن الكائنات النصية التي تمثلها: زوج من الأقواس، زوج من الأقواس المعقوفة، وكلمة.

لننظر إلى مثال أخير. لنفترض أن لديك هذه العلامات HTML:

```html
<div>
  <h1>Header1</h1>
  <p>Paragraph1</p>
  <p>Paragraph2</p>
</div>
```

إذا كان المؤشر لديك على نص "Header1":
- لحذف "Header1": `dit`.
- لحذف `<h1>Header1</h1>`: `dat`.

إذا كان المؤشر لديك على "div":
- لحذف `h1` وكلا سطري `p`: `dit`.
- لحذف كل شيء: `dat`.
- لحذف "div": `di<`.

أدناه قائمة بكائنات النص الشائعة:

```shell
w         كلمة
p         فقرة
s         جملة
( أو )    زوج من ( )
{ أو }    زوج من { }
[ أو ]    زوج من [ ]
< أو >    زوج من < >
t         علامات XML
"         زوج من " "
'         زوج من ' '
`         زوج من ` `
```

لتعلم المزيد، تحقق من `:h text-objects`.

## القابلية للتكوين والنحو

قواعد نحوية Vim هي مجموعة فرعية من ميزة القابلية للتكوين في Vim. دعنا نناقش القابلية للتكوين في Vim ولماذا هذه ميزة رائعة أن تكون موجودة في محرر نصوص.

تشير القابلية للتكوين إلى وجود مجموعة من الأوامر العامة التي يمكن دمجها (تكوينها) لأداء أوامر أكثر تعقيدًا. تمامًا كما في البرمجة حيث يمكنك إنشاء تجريدات أكثر تعقيدًا من تجريدات أبسط، في Vim يمكنك تنفيذ أوامر معقدة من أوامر أبسط. قواعد نحوية Vim هي تجسيد للطبيعة القابلة للتكوين لـ Vim.

تتألق القوة الحقيقية لقابلية تكوين Vim عندما تتكامل مع البرامج الخارجية. يحتوي Vim على عامل تصفية (`!`) لاستخدام البرامج الخارجية كمرشحات لنصوصنا. لنفترض أن لديك هذا النص الفوضوي أدناه وترغب في جعله في جدول:

```shell
Id|Name|Cuteness
01|Puppy|Very
02|Kitten|Ok
03|Bunny|Ok
```

لا يمكن القيام بذلك بسهولة باستخدام أوامر Vim، لكن يمكنك إنجازه بسرعة باستخدام أمر الطرفية `column` (بافتراض أن طرفيتك تحتوي على أمر `column`). مع وجود المؤشر على "Id"، قم بتشغيل `!}column -t -s "|"`. ها هو! الآن لديك هذه البيانات الجداولية الجميلة مع مجرد أمر سريع واحد.

```shell
Id  Name    Cuteness
01  Puppy   Very
02  Kitten  Ok
03  Bunny   Ok
```

دعنا نفكك الأمر. كان الفعل هو `!` (عامل التصفية) والاسم كان `}` (الذهاب إلى الفقرة التالية). قبل عامل التصفية `!` قبول حجة أخرى، أمر طرفية، لذا أعطيته `column -t -s "|"`. لن أذهب في كيفية عمل `column`، لكن في الواقع، جعل النص في جدول.

لنفرض أنك تريد ليس فقط جعل نصك في جدول، ولكن عرض الصفوف التي تحتوي على "Ok" فقط. أنت تعرف أن `awk` يمكنه القيام بالمهمة بسهولة. يمكنك القيام بذلك بدلاً من ذلك:

```shell
!}column -t -s "|" | awk 'NR > 1 && /Ok/ {print $0}'
```

النتيجة:

```shell
02  Kitten  Ok
03  Bunny   Ok
```

رائع! يمكن لعامل الأمر الخارجي أيضًا استخدام الأنابيب (`|`).

هذه هي قوة قابلية تكوين Vim. كلما عرفت المزيد عن عوامل التشغيل، الحركات، وأوامر الطرفية، تزداد قدرتك على تكوين إجراءات معقدة *بشكل مضاعف*.

لنفرض أنك تعرف فقط أربع حركات، `w، $، }، G` وعامل واحد فقط، `d`. يمكنك القيام بـ 8 إجراءات: *التحرك* 4 طرق مختلفة (`w، $، }، G`) و *الحذف* 4 أهداف مختلفة (`dw، d$، d}، dG`). ثم في يوم من الأيام تتعلم عن عامل الحرف الكبير (`gU`). لقد أضفت ليس فقط قدرة جديدة واحدة إلى حزام أدوات Vim الخاص بك، ولكن *أربعة*: `gUw، gU$، gU}، gUG`. هذا يجعل 12 أداة في حزام أدوات Vim الخاص بك. كل معرفة جديدة هي مضاعف لقدراتك الحالية. إذا كنت تعرف 10 حركات و 5 عوامل، لديك 60 حركة (50 عملية + 10 حركات) في ترسانتك. يحتوي Vim على حركة رقم السطر (`nG`) التي تعطيك `n` حركات، حيث `n` هو عدد الأسطر لديك في ملفك (للذهاب إلى السطر 5، قم بتشغيل `5G`). حركة البحث (`/`) تعطيك تقريبًا عددًا غير محدود من الحركات لأنك تستطيع البحث عن أي شيء. عامل الأمر الخارجي (`!`) يمنحك عددًا من أدوات التصفية بقدر عدد أوامر الطرفية التي تعرفها. باستخدام أداة قابلة للتكوين مثل Vim، يمكن ربط كل ما تعرفه معًا للقيام بعمليات تزداد تعقيدًا. كلما عرفت أكثر، أصبحت أكثر قوة.

تتردد هذه السلوكيات القابلة للتكوين مع فلسفة Unix: *قم بشيء واحد بشكل جيد*. لدى العامل وظيفة واحدة: قم بـ Y. لدى الحركة وظيفة واحدة: اذهب إلى X. من خلال دمج عامل مع حركة، تحصل بشكل متوقع على YX: قم بـ Y على X.

الحركات والعوامل قابلة للتوسيع. يمكنك إنشاء حركات وعوامل مخصصة لإضافتها إلى حزام أدوات Vim الخاص بك. يسمح لك ملحق [`vim-textobj-user`](https://github.com/kana/vim-textobj-user) بإنشاء كائنات نصية خاصة بك. كما يحتوي على [قائمة](https://github.com/kana/vim-textobj-user/wiki) من كائنات النص المخصصة التي أنشأها المستخدمون.

## تعلم قواعد نحوية Vim بطريقة ذكية

لقد تعلمت للتو عن قاعدة قواعد نحوية Vim: `فعل + اسم`. كانت واحدة من أكبر لحظات "AHA!" في Vim بالنسبة لي عندما كنت قد تعلمت للتو عن عامل الحرف الكبير (`gU`) وأردت تحويل الكلمة الحالية إلى أحرف كبيرة، قمت *بغريزة* بتشغيل `gUiw` وعمل! تم تحويل الكلمة إلى أحرف كبيرة. في تلك اللحظة، بدأت أخيرًا أفهم Vim. آمل أن يكون لديك لحظة "AHA!" الخاصة بك قريبًا، إن لم تكن قد حصلت عليها بالفعل.

الهدف من هذا الفصل هو أن أظهر لك نمط `فعل + اسم` في Vim حتى تتعامل مع تعلم Vim كما لو كنت تتعلم لغة جديدة بدلاً من حفظ كل مجموعة من الأوامر.

تعلم النمط وفهم الآثار المترتبة عليه. هذه هي الطريقة الذكية للتعلم.